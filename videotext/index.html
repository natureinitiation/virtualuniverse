<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Text converter for fast reading</title>
<link rel="manifest" href="manifest.json">
<style>
  body, html {
    height: 100%;
    margin: 0;
    display: flex;
    flex-direction: column;
    background-color: #222;
    color: #fff;
    font-family: Arial, sans-serif;
  }
  #inputContainer {
    padding: 15px;
    text-align: center;
  }
  #inputText {
    width: 90%;
    max-width: 1000px;
    padding: 8px;
    font-size: 16px;
    border-radius: 0px;
    border: none;
  }
  #container {
    flex-grow: 1;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  #word {
    opacity: 1;
    font-weight: bold;
    text-align: center;
    max-width: 90%;
    word-wrap: break-word;
    /* Убираем плавности анимации */
    transition: none;
  }
  #buttonsContainer {
    padding: 10px;
    text-align: center;
  }

  button {
  font-size: 16px;
  background-color: transparent; /* убираем фон */
  color: white;                  /* делаем текст белым */
  border-radius: 8px;
  border: 1px solid white;                  /* убираем рамку */
  padding: 8px 12px;
  outline: none;                 /* убираем обводку при фокусе */
  cursor: pointer;               /* курсор указателя */
}

</style>
</head>
<body>
  <div id="inputContainer">
    <input type="text" id="inputText" value="How do you like this reading experience? Okay, speed reading, but the main thing is that it's much more effective at absorbing information since there's no extraneous text. Just enter the text at the top of the window and click «Start» at the bottom. You can also adjust the speed there. Make a video. Best wishes." />
  </div>

  <div id="container">
    <div id="word"></div>
  </div>

  <div id="buttonsContainer">
    <button id="fasterBtn">Faster</button>
        <button id="startBtn">Start</button> 
    <button id="slowerBtn">Slower</button>
  </div>

<script>
  const wordElement = document.getElementById('word');
  const inputText = document.getElementById('inputText');
  const startBtn = document.getElementById('startBtn');
  const fasterBtn = document.getElementById('fasterBtn');
  const slowerBtn = document.getElementById('slowerBtn');

  let words = inputText.value.split(' ');
  let index = 0;
  let interval = 1500; // начальная скорость в мс
  let timer = null;

  function setFontSize(word) {
    const baseSize = window.innerWidth / 10;
    const wordLength = word.length;
    let size = baseSize;
    if (wordLength > 15) size = baseSize / 1.2;
    if (wordLength > 30) size = baseSize / 1.5;
    if (wordLength > 45) size = baseSize / 2;
    wordElement.style.fontSize = size + 'px';
  }

  function showNextWordInstant() {
    if (index >= words.length) {
      index = 0; // Зацикливание
    }

    let currentWord = words[index];
    wordElement.textContent = currentWord;
    setFontSize(currentWord);

    // Проверяем, содержит ли слово знак препинания
    const punctuation = /[.,—:;!?]/;
    const hasPunctuation = punctuation.test(currentWord);
    // Динамический множитель паузы: больше для меньших интервалов
    const pauseMultiplier = interval <= 300 ? 4 : interval <= 500 ? 3 : 2;
    const currentInterval = hasPunctuation ? interval * pauseMultiplier : interval;

    index++;

    // Очищаем предыдущий таймер
    clearTimeout(timer);
    // Устанавливаем новый таймер
    timer = setTimeout(showNextWordInstant, currentInterval);
  }

  function startAnimation() {
    words = inputText.value.trim().split(/\s+/);
    if (words.length === 0) return;
    index = 0;
    clearTimeout(timer);
    showNextWordInstant();
  }

  startBtn.onclick = startAnimation;

  fasterBtn.onclick = () => {
    if (interval > 100) {
      interval -= 100;
      clearTimeout(timer);
      showNextWordInstant();
    }
  };

  slowerBtn.onclick = () => {
    interval += 200;
    clearTimeout(timer);
    showNextWordInstant();
  };

  window.onload = startAnimation;

  window.onresize = () => {
    if (words.length > 0) {
      let currentWord = wordElement.textContent || words[index];
      setFontSize(currentWord);
    }
  };
</script>

</body>
</html>
