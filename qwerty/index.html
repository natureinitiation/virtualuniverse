<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QWERTY –≤ –Ø–®–ï–†–¢–´</title>
    <style>
        /* --- –û–°–ù–û–í–ù–´–ï –°–¢–ò–õ–ò --- */
        body {
            font-family: Arial, sans-serif;
            margin-top: 30px;
            margin-bottom: 30px;
            background-color: #121212;
            color: #e0e0e0;
        }
        .container {
            max-width: 800px;
            margin: auto;
            background: #1e1e1e;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            margin-bottom: 20px;
        }
        h1 {
            color: #bb86fc;
            border-bottom: 2px solid #bb86fc;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        textarea {
            width: 100%;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid #333;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 16px;
            resize: vertical;
            background-color: #2c2c2c;
            color: #e0e0e0;
            min-height: 80px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        /* --- –°–ö–†–´–í–ê–ï–ú –ê–ö–¢–ò–í–ù–û–ï –ü–û–õ–ï –í–í–û–î–ê --- */
        #latinInput {
            opacity: 0; 
            height: 0;
            padding: 0;
            margin-bottom: 0;
            border: none;
            overflow: hidden;
            resize: none;
        }
        /* --- –°—Ç–∏–ª–∏ –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª—è (–¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≤–≤–æ–¥–∞) --- */
        #cyrillicOutput {
            min-height: 120px;
            cursor: default;
        }
        .copy-button {
            padding: 10px 15px;
            font-size: 16px;
            background-color: #03dac6;
            color: #121212;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 5px;
            display: block;
            width: 100%;
        }
        .copy-button:hover {
            background-color: #039c8c;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–¥–≤–∞–ª–∞ (—Å—Å—ã–ª–∫–∏) */
        .page-footer {
            max-width: 800px;
            margin: 20px auto 0;
            padding: 0 30px;
        }
        .page-footer a {
            color: #bb86fc;
            text-decoration: none;
            font-size: 14px;
        }
        .page-footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>QWERTY –≤ –Ø–®–ï–†–¢–´</h1>
    <p>–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏—é –ª–∞—Ç–∏–Ω—Å–∫–∏—Ö –±—É–∫–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏—Ö (–≤–∫–ª—é—á–∞—è —É–∫—Ä–∞–∏–Ω—Å–∫–∏–µ): ZH –¥–ª—è –ñ, CH ‚Äî –ß, SH ‚Äî –®, SHH, SCH –∏–ª–∏ CSH ‚Äî –©, E ‚Äî –≠, IE ‚Äî –Ñ, YE ‚Äî –ï, YO ‚Äî –Å, YU ‚Äî –Æ, IE ‚Äî –ï, YA ‚Äî –Ø, CZ –∏–ª–∏ TS ‚Äî –¶, II ‚Äî I, YI ‚Äî –á, ''' ‚Äî –™, '' ‚Äî –¨, --- –¥–ª–∏–Ω–Ω–æ–µ —Ç–∏—Ä–µ, -- –º–∏–Ω—É—Å</p>
    
    <label for="cyrillicOutput">–í–∞—à –¢–µ–∫—Å—Ç:</label>
    <textarea id="cyrillicOutput" rows="6" readonly placeholder="–¢–µ–∫—Å—Ç –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å..."></textarea>
    
    <button id="copyButton" class="copy-button">
        üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ö–∏—Ä–∏–ª–ª–∏—Ü—É
    </button>
    
    <label for="latinInput" style="display: none;">–ê–∫—Ç–∏–≤–Ω—ã–π –í–≤–æ–¥ (–°–∫—Ä—ã—Ç):</label>
    <textarea id="latinInput" rows="2" placeholder="–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å"></textarea>

</div>

<div class="page-footer">
    <a href="https://eugenebox.t.me/" target="_blank">
        Help
    </a>
</div>

<script>
    // 1. –ë–ê–ó–û–í–´–ï –ü–†–ê–í–ò–õ–ê (—É–±—Ä–∞–ª–∏ '' –∏ ''' –æ—Ç—Å—é–¥–∞!)
    const MAPPING_LOWERCASE_BASE = new Map([
        ['zh', '–∂'], ['ch', '—á'], ['sh', '—à'], ['shh', '—â'], ['csh', '—â'], ['cz', '—Ü'], ['yu', '—é'],
        ['ya', '—è'], ['yo', '—ë'], ['ie', '—î'], ['ye', '–µ'], ['y', '—ã'], ['ii', '—ñ'],
        ['ts', '—Ü'], ['sch', '—â'],
        ['e', '—ç'], ['j', '–π'], ['i', '–∏'],
        ["---", '‚Äî'], ["--", '‚Äì'],
        ['yi', '—ó'],
        ['a', '–∞'], ['b', '–±'], ['v', '–≤'], ['g', '–≥'], ['d', '–¥'],
        ['k', '–∫'], ['l', '–ª'], ['m', '–º'], ['n', '–Ω'], ['o', '–æ'],
        ['p', '–ø'], ['r', '—Ä'], ['s', '—Å'], ['t', '—Ç'],
        ['u', '—É'], ['f', '—Ñ'], ['x', '—Ö'], ['z', '–∑'],
    ]);

    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–µ–≥–∏—Å—Ç—Ä–∞ (SH, Sh, sh ‚Üí –®, –®, —à)
    function generateCaseVariations(str, cyr) {
        const variations = new Map();
        const len = str.length;
        const numVariations = 1 << len;
       
        for (let i = 0; i < numVariations; i++) {
            let variation = '';
            let isAllUpper = true;
           
            for (let j = 0; j < len; j++) {
                if ((i >> j) & 1) {
                    variation += str[j].toUpperCase();
                } else {
                    variation += str[j];
                    isAllUpper = false;
                }
            }
           
            let cyrOutput = cyr;
            if (isAllUpper) {
                cyrOutput = cyr.toLocaleUpperCase('ru');
            }
            variations.set(variation, cyrOutput);
        }
        return variations;
    }
   
    // –û—Å–Ω–æ–≤–Ω–æ–π —Å–ª–æ–≤–∞—Ä—å
    const MAPPING = new Map();

    // –ü—Ä–æ–±–µ–ª—ã, –∑–Ω–∞–∫–∏ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è, —Ü–∏—Ñ—Ä—ã
    const NON_ALPHABET_CHARS = new Map([
        [' ', ' '], ['.', '.'], [',', ','], ['!', '!'], ['?', '?'],
        ['0', '0'], ['1', '1'], ['2', '2'], ['3', '3'], ['4', '4'],
        ['5', '5'], ['6', '6'], ['7', '7'], ['8', '8'], ['9', '9'],
    ]);
    for (const [lat, cyr] of NON_ALPHABET_CHARS) MAPPING.set(lat, cyr);

    // –ó–∞–ø–æ–ª–Ω—è–µ–º –±—É–∫–≤—ã –∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
    for (const [lat, cyr] of MAPPING_LOWERCASE_BASE) {
        if (lat.length > 1) {
            const variations = generateCaseVariations(lat, cyr);
            for (const [v, c] of variations) MAPPING.set(v, c);
        } else {
            MAPPING.set(lat, cyr);
            if (lat.match(/[a-z]/i)) {
                MAPPING.set(lat.toUpperCase(), cyr.toUpperCase());
            }
        }
    }

    // –°–ü–ï–¶–ò–ê–õ–¨–ù–û: –≤—Å–µ–≥–¥–∞ –º–∞–ª–µ–Ω—å–∫–∏–µ —å –∏ —ä (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
    MAPPING.set("''", '—å');
    MAPPING.set("'''", '—ä');
    MAPPING.set("'' ", '—å ');
    MAPPING.set("''' ", '—ä ');
    MAPPING.set("'',", '—å,');
    MAPPING.set("''.", '—å.');
    MAPPING.set("''!", '—å!');
    MAPPING.set("''?", '—å?');
    MAPPING.set("'''!", '—ä!');
    MAPPING.set("'''?", '—ä?');

    // –í–ê–ñ–ù–û: —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∫–ª—é—á–µ–π –ø–æ —É–±—ã–≤–∞–Ω–∏—é –¥–ª–∏–Ω—ã (—á—Ç–æ–±—ã shh –Ω–∞—Ö–æ–¥–∏–ª–æ—Å—å —Ä–∞–Ω—å—à–µ sh)
    const sorted_keys = Array.from(MAPPING.keys()).sort((a, b) => b.length - a.length);

    // –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –¢–†–ê–ù–°–õ–ò–¢–ê
    function transcodeToCyrillic(lat_text) {
        if (!lat_text) return '';

        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º: –≤–µ—Å—å –ª–∏ —Ç–µ–∫—Å—Ç –Ω–∞–±—Ä–∞–Ω –ó–ê–ì–õ–ê–í–ù–´–ú–ò –ª–∞—Ç–∏–Ω—Å–∫–∏–º–∏ –±—É–∫–≤–∞–º–∏?
        const cleanText = lat_text.replace(/'+/g, '').replace(/[-‚Äì‚Äî ]/g, '').trim();
        const isAllCaps = cleanText.length > 0 && cleanText === cleanText.toUpperCase();

        let output = [];
        let i = 0;
        while (i < lat_text.length) {
            let found = false;
            for (const key of sorted_keys) {
                if (lat_text.substr(i, key.length) === key) {
                    let cyr = MAPPING.get(key);

                    // –ï—Å–ª–∏ –≤–µ—Å—å —Ç–µ–∫—Å—Ç –≤ CAPS LOCK ‚Äî –¥–µ–ª–∞–µ–º –¨ –∏ –™ –∑–∞–≥–ª–∞–≤–Ω—ã–º–∏
                    if (isAllCaps && cyr === '—å') cyr = '–¨';
                    if (isAllCaps && cyr === '—ä') cyr = '–™';

                    output.push(cyr);
                    i += key.length;
                    found = true;
                    break;
                }
            }
            if (!found) {
                output.push(lat_text[i]);
                i++;
            }
        }
        return output.join('');
    }

    // === –í–°–Å –ù–ò–ñ–ï ‚Äî –û–°–¢–ê–Å–¢–°–Ø –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô ===
    const latinInput = document.getElementById('latinInput');
    const cyrillicOutput = document.getElementById('cyrillicOutput');
    const copyButton = document.getElementById('copyButton');

    latinInput.addEventListener('input', function() {
        cyrillicOutput.value = transcodeToCyrillic(latinInput.value);
    });

    document.addEventListener('click', () => latinInput.focus());
    document.addEventListener('touchstart', () => latinInput.focus());

    copyButton.addEventListener('click', function() {
        const textToCopy = cyrillicOutput.value;
        if (navigator.clipboard && textToCopy) {
            navigator.clipboard.writeText(textToCopy).then(() => {
                copyButton.textContent = '–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
                setTimeout(() => copyButton.textContent = '–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ö–∏—Ä–∏–ª–ª–∏—Ü—É', 1500);
            });
        } else {
            alert('–ù–µ—Ç —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è.');
        }
        latinInput.focus();
    });

    latinInput.focus();
</script>

</body>
</html>
